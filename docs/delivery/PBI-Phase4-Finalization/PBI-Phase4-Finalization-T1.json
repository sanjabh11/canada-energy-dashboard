{
  "task_id": "PBI-Phase4-Finalization-T1",
  "title": "Validate data foundation, harden tests with timeouts, and clean PRD 404s if resolved",
  "type": "test",
  "status": "InProgress",
  "files": [
    "docs/delivery/backlog_index.json",
    "docs/delivery/PBI-Phase4-Finalization/tasks_index.json",
    "docs/delivery/PBI-Phase4-Finalization/implementation_log.md",
    "tests/test_llm_endpoints.js",
    "prd.md",
    "supabase/functions/llm/index.ts",
    "supabase/functions/llm-health-probe/index.ts",
    "supabase/functions/llm-lite/index.ts",
    "src/lib/constants.ts",
    "src/lib/llmClient.ts",
    "src/lib/config.ts"
  ],
  "test_plan": {
    "purpose": "Verify that REST tables exist (200 vs 404) and Edge health endpoints respond; ensure tests cannot hang by enforcing timeouts",
    "steps": [
      "Use curl to check existence of provincial_generation, ontario_hourly_demand, alberta_supply_demand, weather_data tables (expect 200, not 404)",
      "Use curl to hit Edge health endpoints for stream-ontario-demand (expect 200 JSON)",
      "Run tests/test_llm_endpoints.js locally against LLM function with timeouts enforced; confirm no hang and proper status codes",
      "If REST tables return 200 and no more 404 in console, remove the stale 404 snippet from prd.md"
    ],
    "success_criteria": [
      "All REST endpoints return 200 (even if empty array)",
      "Edge health endpoint returns 200 with JSON payload",
      "All test functions complete within 15s each and print PASS criteria",
      "prd.md updated to remove outdated 404 snippet if validations pass"
    ]
  },
  "status_history": [
    { "ts": "2025-09-15T11:45:20+05:30", "status": "InProgress", "note": "Task created and registered" }
  ]
}
